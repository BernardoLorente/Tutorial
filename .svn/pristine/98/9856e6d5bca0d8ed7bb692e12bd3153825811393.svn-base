<?php include './header.html.php';?>
<div id = 'main'>
<form method='post' id='myProblemForm'>
  <table class='table table-condensed table-hover table-striped tablesorter' align="center" id='problemtable'>
    <?php $vars = "viewtype=$viewtype&orderBy=%s&recTotal=$recTotal&recPerPage=$recPerPage&pageID=$pageID"; ?>
    <thead>
      <tr class='text-center'>
        <th width="10px" class='text-left'> <?php common::printOrderLink('id',$orderBy, $vars, $lang->idAB);?></th>
        <th class='w-150px text-left'><?php common::printOrderLink('title',$orderBy, $vars, $lang->problem->title);?></th>
      <?php if ($this->session->userinfo->roleid != 'student'):?>
        <th class='w-20px'> <?php echo common::printOrderLink('asgID', $orderBy, $vars, $lang->problem->creator);?></th>
      <?php
        endif;
        if ($this->session->userinfo->roleid != 'teacher'):
      ?>
        <th class='w-20px'> <?php echo common::printOrderLink('acpID', $orderBy, $vars, $lang->problem->receiver);?></th>
      <?php endif;?>
        <th class='w-50px'> <?php echo common::printOrderLink('createtime', $orderBy, $vars, $lang->problem->createtime);?></th>
      <?php if (($this->session->userinfo->roleid == 'student') && ($viewtype == 'isRead')):?>
        <th class='w-50px'> <?php echo common::printOrderLink('readtime', $orderBy, $vars, $lang->problem->readtime);?></th>
      <?php endif;?>
        <th class='w-40px'> <?php echo $lang->problem->solvetime;?></th>
      <?php if ($viewtype == 'all'):?>
        <th class='w-40px'> <?php echo $lang->problem->isRead;?></th>
      <?php endif;
      if ($this->session->userinfo->roleid == 'student'):?> 
        <th class='w-40px'> <?php echo $lang->actions;?></th>
      <?php endif;?>
      </tr>
    </thead>
    <tbody>
    <?php foreach ($problems as $problem):?>
      <tr class='text-center'>
        <td class='text-left'><?php echo sprintf('%03d', $problem->id);?></td>
        <td class='text-left'><?php echo html::a($this->createLink('problem', 'view', "problemID=$problem->id"), $problem->title);?></td>
      <?php if ($this->session->userinfo->roleid != 'student'):?>
        <td><?php echo $users[$problem->asgID];?></td>
      <?php
        endif;
        if ($this->session->userinfo->roleid != 'teacher'):
      ?>
        <td><?php echo $users[$problem->acpID];?></td>
      <?php endif;?>
        <td><?php echo $problem->createtime;?></td>
      <?php if (($this->session->userinfo->roleid == 'student') && ($viewtype == 'isRead')):?>
        <td><?php echo $problem->readtime;?></td>
      <?php endif;?>
        <td><?php echo $problem->solvetime;?></td>
      <?php if ($viewtype == 'all'):?>
        <td><?php echo $lang->problem->readStatusList[($problem->readtime != null) && ($problem->readtime != '0000-00-00 00:00:00')];?></td>
      <?php endif;
      if ($problem->asgID == $this->session->user->account):?> 
        <td>
          <?php 
            if ($problem->completetime == null)
            {
              common::printIcon('problem', 'edit', "problemID=$problem->id", '', 'list');
              common::printIcon('problem', 'delete', "problemID=$problem->id", '', 'list', '', 'hiddenwin');
              if (($problem->readtime != null) && ($problem->readtime != '0000-00-00 00:00:00'))
                common::printIcon('problem', 'complete', "problemID=$problem->id", '', 'list', 'ok', 'hiddenwin');                  
            }
          ?>
        </td>
      <?php endif;?>
      </tr>
    <?php endforeach;?>
    </tbody>
    <tfoot>
        <tr>
        <?php $columns = $this->cookie->windowWidth > $this->config->wideSize ? 14 : 12;?>
          <td colspan='<?php echo $columns;?>'>
            <?php $pager->show();?>
          </td>
        </tr>
    </tfoot>
  </table> 
</form>
</div>
<?php include '../../common/view/footer.html.php';?>
